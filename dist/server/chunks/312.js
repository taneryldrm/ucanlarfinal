"use strict";exports.id=312,exports.ids=[312],exports.modules={1312:(e,s,t)=>{t.d(s,{t:()=>m});var l=t(5344),a=t(4513),r=t(1838),n=t(8765),o=t(2739),d=t(3729),i=t(1626),c=t(7973),u=t(4755),x=t(9641);function m({isOpen:e,onClose:s,initialData:t,onSave:m}){let[b,p]=(0,d.useState)(""),[h,f]=(0,d.useState)([]),[g,j]=(0,d.useState)(t?.customer||null),[N,v]=(0,d.useState)(!1),[y,w]=(0,d.useState)(!1),[S,k]=(0,d.useState)(!1),[C,_]=(0,d.useState)(""),[T,z]=(0,d.useState)([]),[O,L]=(0,d.useState)(t?.staffIds||[]),[P,E]=(0,d.useState)(t?.date||new Date().toISOString().split("T")[0]),[D,Z]=(0,d.useState)(t?.staffCount||1),[I,M]=(0,d.useState)(t?.description||""),[A,G]=(0,d.useState)(t?.address||""),[B,H]=(0,d.useState)(t?.amount||""),[q,K]=(0,d.useState)(!1),[Y,F]=(0,d.useState)("once_week"),[Q,R]=(0,d.useState)([]),[J,U]=(0,d.useState)(()=>{let e=new Date;return e.setMonth(e.getMonth()+3),e.toISOString().split("T")[0]}),V=(0,d.useRef)(null);(0,d.useEffect)(()=>{e&&(0,c.sE)(1,50).then(e=>{e.data&&z(e.data)})},[e]),(0,d.useEffect)(()=>{if(e){if(t){let e=t.customerObj||t.customer||null;j(e),p(e?.name||("string"==typeof t.customer?t.customer:"")||""),E(t.date?new Date(t.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0]),M(t.description||""),G(t.address||""),H(void 0!==t.amount&&null!==t.amount?String(t.amount):""),Z(t.personnel_count||1),L(t.assigned_staff||[]),K(t.is_recurring||!1),F(t.frequency||"once_week")}else j(null),p(""),E(new Date().toISOString().split("T")[0]),M(""),G(""),H(""),Z(1),L([]),K(!1),F("once_week");f([]),w(!1)}},[e,t]),(0,d.useEffect)(()=>{if(V.current&&clearTimeout(V.current),!b.trim()){f([]),w(!1);return}if(!g||b!==g.name)return V.current=setTimeout(async()=>{v(!0);try{let{data:e}=await (0,c.OL)(1,10,b);f(e||[]),w(!0)}catch(e){console.error(e)}finally{v(!1)}},300),()=>{V.current&&clearTimeout(V.current)}},[b,g]);let W=e=>{j(e),p(e.name),G(e.address||""),w(!1)},X=e=>{L(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},$=(e,s)=>{R(t=>t.includes(e)?t.filter(s=>s!==e):t.length>=s?t:[...t,e])},ee=async()=>{if(!g){u.toast.error("L\xfctfen bir m\xfcşteri se\xe7in.");return}if(!P){u.toast.error("L\xfctfen tarih se\xe7in.");return}let e={customer_id:g.id,date:P,description:I,address:A,price:parseFloat(B||"0"),personnel_count:D,is_recurring:q,frequency:q?Y:null,recurring_days:q?Q:[],recurring_end_date:q?J:null,assigned_staff:O};try{console.log("Saving payload:",e),m?await m(e):u.toast.success("Kayıt işlemi (Demo): Başarılı"),s()}catch(e){console.error("Save error:",e),u.toast.error("Hata oluştu: "+(e.message||e.toString()))}};return e?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 backdrop-blur-sm p-4",children:(0,l.jsxs)("div",{className:"w-full max-w-3xl rounded-xl bg-white shadow-2xl animate-in fade-in zoom-in duration-200 flex flex-col max-h-[90vh]",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between border-b border-slate-100 p-6 shrink-0",children:[l.jsx("h2",{className:"text-xl font-bold text-slate-900",children:t?"İş Emri D\xfczenle":"Yeni İş Emri Oluştur"}),l.jsx("button",{onClick:s,className:"rounded-lg p-2 text-slate-400 hover:bg-slate-50 hover:text-slate-600 transition-colors",children:l.jsx(a.Z,{className:"h-5 w-5"})})]}),(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[(0,l.jsxs)("div",{className:"space-y-2 relative",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("label",{className:"text-sm font-bold text-slate-900",children:["M\xfcşteri ",l.jsx("span",{className:"text-red-500",children:"*"})]}),(0,l.jsxs)("button",{onClick:()=>k(!0),className:"flex items-center gap-1 rounded border border-slate-200 px-2 py-1 text-xs font-medium text-slate-600 hover:bg-slate-50",children:[l.jsx(r.Z,{className:"h-3 w-3"}),"Yeni M\xfcşteri Oluştur"]})]}),l.jsx(x.Q,{isOpen:S,onClose:()=>k(!1),onSuccess:e=>{W(e)}}),(0,l.jsxs)("div",{className:"relative",children:[l.jsx(n.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),l.jsx("input",{type:"text",value:b,onChange:e=>{p(e.target.value),g&&e.target.value!==g.name&&j(null)},placeholder:"M\xfcşteri ara (isim veya telefon)...",className:"w-full rounded-lg border border-slate-200 py-2.5 pl-10 pr-4 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10"}),N&&l.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:l.jsx(o.Z,{className:"h-4 w-4 animate-spin text-slate-400"})})]}),y&&h.length>0&&l.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-slate-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:h.map(e=>(0,l.jsxs)("button",{onClick:()=>W(e),className:"w-full text-left px-4 py-3 hover:bg-slate-50 border-b border-slate-50 last:border-0",children:[l.jsx("div",{className:"font-bold text-slate-900 text-sm",children:e.name}),(0,l.jsxs)("div",{className:"text-xs text-slate-500",children:[e.phone," - ",e.address]})]},e.id))}),y&&0===h.length&&b.length>2&&!N&&l.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white p-4 text-sm text-slate-500 text-center border border-slate-200 rounded-lg shadow-lg",children:"Sonu\xe7 bulunamadı."})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("label",{className:"text-sm font-bold text-slate-900",children:["İş Tarihi ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"date",value:P,onChange:e=>E(e.target.value),className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("label",{className:"text-sm font-bold text-slate-900",children:["Personel Sayısı ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"number",value:D,onChange:e=>Z(Number(e.target.value)),min:1,className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10"})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("label",{className:"text-sm font-bold text-slate-900",children:["Personel Se\xe7imi ",l.jsx("span",{className:"text-xs font-normal text-slate-500",children:"(Opsiyonel - sonra d\xfczenleme ile atanabilir)"})]}),(0,l.jsxs)("div",{className:"rounded-lg border border-slate-200 p-4 space-y-3",children:[(0,l.jsxs)("div",{className:"relative mb-3",children:[l.jsx(n.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),l.jsx("input",{type:"text",value:C,onChange:e=>_(e.target.value),placeholder:"Listede ara...",className:"w-full rounded-lg border border-slate-200 py-2 pl-10 pr-4 text-sm outline-none focus:border-blue-500"})]}),(0,l.jsxs)("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-2",children:[T.filter(e=>e.full_name?.toLowerCase().includes(C.toLowerCase())||e.name?.toLowerCase().includes(C.toLowerCase())).map(e=>(0,l.jsxs)("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-slate-50 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:O.includes(e.id),onChange:()=>X(e.id),className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),l.jsx("span",{className:"text-sm font-medium text-slate-700",children:e.full_name||e.name})]},e.id)),0===T.length&&l.jsx("div",{className:"text-xs text-slate-400 text-center py-2",children:"Personel bulunamadı"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"A\xe7ıklama"}),l.jsx("input",{type:"text",value:I,onChange:e=>M(e.target.value),placeholder:"İş a\xe7ıklaması...",className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Adres"}),l.jsx("input",{type:"text",value:A,onChange:e=>G(e.target.value),placeholder:"İş adresi...",className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10"})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("label",{className:"text-sm font-bold text-slate-900",children:["Tutar (₺) ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"number",value:B,onChange:e=>H(e.target.value),placeholder:"0.00",className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10"})]}),(0,l.jsxs)("div",{className:"space-y-4 pt-2 border-t border-slate-100",children:[(0,l.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:q,onChange:e=>K(e.target.checked),className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),l.jsx("span",{className:"text-sm font-bold text-slate-900",children:"Tekrarlayan İş Emri"})]}),q&&(0,l.jsxs)("div",{className:"space-y-4 pl-6 animate-in slide-in-from-top-2 duration-200",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Sıklık"}),(0,l.jsxs)("select",{value:Y,onChange:e=>F(e.target.value),className:"w-full appearance-none rounded-lg border border-slate-200 bg-slate-800 text-white px-4 py-2.5 text-sm outline-none focus:border-blue-500",children:[l.jsx("option",{value:"once_week",children:"Haftada 1"}),l.jsx("option",{value:"twice_week",children:"Haftada 2"}),l.jsx("option",{value:"once_month",children:"Ayda 1"})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Bitiş Tarihi"}),l.jsx("input",{type:"date",value:J,onChange:e=>U(e.target.value),className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10"})]}),"once_week"===Y&&(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"G\xfcn Se\xe7imi"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:["Pzt","Sal","\xc7ar","Per","Cum","Cmt","Paz"].map(e=>l.jsx("button",{onClick:()=>$(e,1),className:(0,i.cn)("px-3 py-1.5 rounded text-sm font-medium border transition-colors",Q.includes(e)?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-600 border-slate-200 hover:bg-slate-50"),children:e},e))})]}),"twice_week"===Y&&(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"G\xfcn Se\xe7imi (En fazla 2)"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:["Pzt","Sal","\xc7ar","Per","Cum","Cmt","Paz"].map(e=>l.jsx("button",{onClick:()=>$(e,2),className:(0,i.cn)("px-3 py-1.5 rounded text-sm font-medium border transition-colors",Q.includes(e)?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-600 border-slate-200 hover:bg-slate-50"),children:e},e))})]}),"once_month"===Y&&(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"G\xfcn Se\xe7imi"}),l.jsx("select",{className:"w-full appearance-none rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm outline-none focus:border-blue-500",children:Array.from({length:31},(e,s)=>s+1).map(e=>(0,l.jsxs)("option",{value:e,children:[e,". G\xfcn"]},e))})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("label",{className:"text-sm font-bold text-slate-900",children:["Bitiş Tarihi ",l.jsx("span",{className:"text-xs font-normal text-slate-500",children:"(Opsiyonel)"})]}),l.jsx("input",{type:"date",className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10"})]})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-3 border-t border-slate-100 p-6 bg-slate-50 shrink-0 rounded-b-xl",children:[l.jsx("button",{onClick:s,className:"rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-50",children:"İptal"}),l.jsx("button",{onClick:ee,className:"rounded-lg bg-blue-600 px-6 py-2 text-sm font-medium text-white hover:bg-blue-700 shadow-md shadow-blue-200",children:"Kaydet"})]})]})}):null}},2739:(e,s,t)=>{t.d(s,{Z:()=>l});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,t(9224).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])}};