exports.id=424,exports.ids=[424],exports.modules={1999:(e,t,r)=>{Promise.resolve().then(r.bind(r,748))},1739:(e,t,r)=>{Promise.resolve().then(r.bind(r,9069))},7332:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,6840,23)),Promise.resolve().then(r.t.bind(r,8771,23)),Promise.resolve().then(r.t.bind(r,3225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,3982,23))},6301:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,1476,23))},7703:(e,t,r)=>{Promise.resolve().then(r.bind(r,4755))},748:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var a=r(5344),n=r(3729);function o({error:e,reset:t}){return(0,n.useEffect)(()=>{console.error(e)},[e]),(0,a.jsxs)("div",{className:"flex h-[50vh] flex-col items-center justify-center gap-4 text-center",children:[a.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Bir şeyler ters gitti!"}),a.jsx("p",{className:"text-slate-500",children:e.message}),a.jsx("button",{onClick:()=>t(),className:"rounded-lg bg-red-50 px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-100",children:"Tekrar Dene"})]})}},9069:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var a=r(5344),n=r(3729);function o({error:e,reset:t}){return(0,n.useEffect)(()=>{console.error(e)},[e]),a.jsx("html",{children:a.jsx("body",{children:(0,a.jsxs)("div",{className:"flex min-h-screen flex-col items-center justify-center gap-4 text-center",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Bir şeyler yanlış gitti!"}),a.jsx("p",{className:"text-slate-600",children:e.message}),a.jsx("button",{onClick:()=>t(),className:"rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:"Tekrar Dene"})]})})})}},7973:(e,t,r)=>{"use strict";r.d(t,{r_:()=>j,createCollection:()=>N,wK:()=>d,createExpense:()=>O,pU:()=>g,ED:()=>B,createWorkOrder:()=>v,deleteCollection:()=>$,Kc:()=>x,LA:()=>c,deleteExpense:()=>E,he:()=>F,l8:()=>k,$k:()=>b,CV:()=>f,OL:()=>l,Es:()=>S,getDailyTransactions:()=>M,z2:()=>n,S4:()=>s,NJ:()=>y,sE:()=>_,a0:()=>D,cp:()=>Y,IG:()=>p,getStats:()=>P,f1:()=>h,_H:()=>i,$f:()=>w,p8:()=>m,OQ:()=>a,updateCollection:()=>q,uG:()=>u,updateExpense:()=>C,ck:()=>A,updateWorkOrder:()=>I,xl:()=>T});let a=(0,r(3974).createBrowserClient)("https://rzcumzfzurthasgptggd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ6Y3VtemZ6dXJ0aGFzZ3B0Z2dkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYxNDA5MzYsImV4cCI6MjA4MTcxNjkzNn0.NlyDKeMj-4xa7ZSt5wsyRdCOay8w2SAIA-ZTjIRkyHw"),n=async()=>{let[e,t,r]=await Promise.allSettled([a.from("collections").select("amount, date"),a.from("expenses").select("amount, date"),a.from("work_orders").select("price, date, status")]),n="fulfilled"!==e.status||e.value.error?[]:e.value.data,o="fulfilled"!==t.status||t.value.error?[]:t.value.data,i="fulfilled"!==r.status||r.value.error?[]:r.value.data,s=new Date,l=s.toISOString().split("T")[0],d=new Date(s.getFullYear(),s.getMonth(),1).toISOString().split("T")[0],c=new Date(s.getFullYear(),s.getMonth()+1,0).toISOString().split("T")[0],u=(e,t)=>e.reduce((e,r)=>e+(r[t]??0),0);u(n,"amount");let m=u(i,"price"),p=i.filter(e=>e.date>=l&&"onaylandı"===e.status).reduce((e,t)=>e+(t.price??0),0),f=n.filter(e=>e.date>=d&&e.date<=c).reduce((e,t)=>e+(t.amount??0),0),g=o.filter(e=>e.date>=d&&e.date<=c).reduce((e,t)=>e+(t.amount??0),0);return{data:{totalIncome:f,totalExpense:g,totalWorkAmount:m,pendingCollection:p,netProfit:f-g},errors:{collections:"fulfilled"===e.status?e.value.error:"rejected"===e.status?e.reason:null,expenses:"fulfilled"===t.status?t.value.error:"rejected"===t.status?t.reason:null,work_orders:"fulfilled"===r.status?r.value.error:"rejected"===r.status?r.reason:null}}};function o(e){return e.toISOString().slice(0,10)}async function i(){let e=new Date;e.setUTCHours(0,0,0,0);let t=new Date(e);t.setUTCDate(e.getUTCDate()+10);let r=o(e),n=o(t),i=await a.from("work_orders").select("date,work_order_assignments(personnel_id,personnel(id,full_name))").gte("date",r).lte("date",n).order("date",{ascending:!0});if(i.error)return{error:i.error};let s=i.data??[],l={};for(let e of s){let t=(e.date||"").slice(0,10);l[t]||(l[t]=[]),l[t].push(e)}return{data:l}}async function s(e,t){let r=new Date(e,t,1),n=new Date(e,t+1,0),i=o(r),s=o(n),{data:l,error:d}=await a.from("work_orders").select(`
      id,
      date,
      description,
      address,
      price,
      status,
      customers (
        name
      ),
      work_order_assignments (
        personnel_id,
        personnel (
          id,
          full_name,
          role,
          phone
        )
      )
    `).gte("date",i).lte("date",s);if(d)throw d;if(!l)return{};let c={};return l.forEach(e=>{let t=(e.date||"").slice(0,10);c[t]||(c[t]=[]);let r={id:e.id,customer:e.customers?.name||"Bilinmeyen M\xfcşteri",status:"onaylandı"===e.status?"Onaylandı":"onaylanmadı"===e.status?"Onay Bekliyor":e.status,description:e.description,address:e.address,amount:e.price?`₺${e.price.toLocaleString("tr-TR")}`:"₺0",staffCount:e.work_order_assignments?.length||0,assignedStaff:e.work_order_assignments?.map(e=>({name:e.personnel?.full_name||"Silinmiş Personel",role:e.personnel?.role||"-",phone:e.personnel?.phone||"-"}))||[]};c[t].push(r)}),c}let l=async(e=1,t=20,r="",n=null)=>{let o=a.from("customers").select("*",{count:"exact"});r&&(o=o.or(`name.ilike.%${r}%,phone.ilike.%${r}%`)),n&&"T\xfcm\xfc"!==n&&(o=o.eq("type",n));let i=(e-1)*t,{data:s,error:l,count:d}=await o.order("name").range(i,i+t-1);if(l)throw l;return{data:s,count:d}},d=async e=>{let{data:t,error:r}=await a.from("customers").insert([{name:e.name,type:e.type,phone:e.phone,tax_id:e.taxId,address:e.address,description:e.description}]).select().single();if(r)throw r;return t},c=async e=>{let{error:t}=await a.from("customers").delete().eq("id",e);if(t)throw t;return!0},u=async(e,t)=>{let{data:r,error:n}=await a.from("customers").update({name:t.name,type:t.type,phone:t.phone,tax_id:t.taxId,address:t.address,description:t.description}).eq("id",e).select().single();if(n)throw n;return r},m=async(e,t)=>{if(!e&&!t)return[];let r=[];if(e){let n=a.from("customers").select("*").or(`name.ilike.%${e}%,phone.ilike.%${e}%`);t&&(n=n.gte("created_at",t.start).lte("created_at",t.end));let{data:o}=await n;o&&r.push(...o.map(e=>({id:e.id,source:"M\xfcşteri",name:e.name,description:`Telefon: ${e.phone||"-"} | Adres: ${e.address||"-"}`,date:e.created_at?new Date(e.created_at).toLocaleDateString("tr-TR"):"-",amount:"-",extraInfo:`Tip: ${e.type||"Normal"} | Bakiye: ₺${e.current_balance||0}`})))}let n=a.from("work_orders").select("*, customers(name)");if(e&&(n=n.ilike("description",`%${e}%`)),t)n=n.gte("date",t.start).lte("date",t.end);else if(!e)return[];let{data:o}=await n.limit(50);o&&r.push(...o.map(e=>({id:e.id,source:"İş Emri",name:e.customers?.name||"Bilinmeyen M\xfcşteri",description:e.description||"A\xe7ıklama Yok",date:new Date(e.date).toLocaleDateString("tr-TR"),amount:`₺${e.price||0}`,extraInfo:`Durum: ${"onaylandı"===e.status?"Onaylandı":"onaylanmadı"===e.status?"Bekliyor":e.status}`})));let i=a.from("collections").select("*, customers(name)");if(e&&(i=i.ilike("description",`%${e}%`)),t&&(i=i.gte("date",t.start).lte("date",t.end)),!e&&!t)return[];let{data:s}=await i.limit(50);if(s&&r.push(...s.map(e=>({id:e.id,source:"Tahsilat",name:e.customers?.name||"Bilinmeyen M\xfcşteri",description:e.description||"Tahsilat",date:new Date(e.date).toLocaleDateString("tr-TR"),amount:`₺${e.amount||0}`,extraInfo:`Y\xf6ntem: ${e.payment_method||"-"}`}))),e){let{data:t}=await a.from("personnel").select("*").or(`full_name.ilike.%${e}%,phone.ilike.%${e}%,role.ilike.%${e}%`).limit(20);t&&r.push(...t.map(e=>({id:e.id,source:"Personel",name:e.full_name,description:`Rol: ${e.role||"-"} | Telefon: ${e.phone||"-"}`,date:"-",amount:`Bakiye: ₺${e.current_balance||0}`,extraInfo:`Durum: ${e.status||"-"}`})))}let l=a.from("expenses").select("*");if(e&&(l=l.ilike("description",`%${e}%`)),t&&(l=l.gte("date",t.start).lte("date",t.end)),e||t){let{data:e}=await l.limit(50);e&&r.push(...e.map(e=>({id:e.id,source:"Gider",name:"Gider Kaydı",description:e.description||"A\xe7ıklama Yok",date:new Date(e.date).toLocaleDateString("tr-TR"),amount:`₺${e.amount||0}`,extraInfo:`Kategori: ${e.category||"-"}`})))}return r},p=async(e="year")=>{let t=new Date,r=new Date;"6months"===e?r.setMonth(t.getMonth()-6):"year"===e?r=new Date(t.getFullYear(),0,1):(r=new Date(t.getFullYear()-1,0,1),t.setFullYear(t.getFullYear()-1),t.setMonth(11),t.setDate(31));let n=r.toISOString().split("T")[0],o=t.toISOString().split("T")[0];try{let{data:e}=await a.from("collections").select("amount, date").gte("date",n).lte("date",o),{data:t}=await a.from("expenses").select("amount, date").gte("date",n).lte("date",o),{data:r}=await a.from("work_orders").select("id, date").gte("date",n).lte("date",o),i={},s=e=>e.substring(0,7);e?.forEach(e=>{let t=s(e.date);i[t]||(i[t]={month:t,gelir:0,gider:0,kar:0}),i[t].gelir+=e.amount}),t?.forEach(e=>{let t=s(e.date);i[t]||(i[t]={month:t,gelir:0,gider:0,kar:0}),i[t].gider+=e.amount}),Object.values(i).forEach(e=>{e.kar=e.gelir-e.gider});let l=Object.values(i).sort((e,t)=>e.month.localeCompare(t.month)).map(e=>({name:new Date(e.month+"-01").toLocaleDateString("tr-TR",{month:"short",year:"numeric"}),gelir:e.gelir,gider:e.gider,kar:e.kar})),d=s(new Date().toISOString()),c=i[d]||{gelir:0,gider:0,kar:0},u=r?.filter(e=>s(e.date)===d).length||0;return{trendData:l,profitData:l.map(e=>({name:e.name,kar:e.kar})),summary:{income:c.gelir,expense:c.gider,profit:c.kar,jobs:u}}}catch(e){return console.error("Report stats error:",e),{trendData:[],profitData:[],summary:{income:0,expense:0,profit:0,jobs:0}}}},f=async()=>{try{let{data:e}=await a.from("customers").select("id, name");if(!e)return[];let{data:t}=await a.from("collections").select("customer_id, amount"),{data:r}=await a.from("work_orders").select("customer_id, amount, status");return e.map(e=>{let a=t?.filter(t=>t.customer_id===e.id)||[],n=r?.filter(t=>t.customer_id===e.id)||[],o=n.reduce((e,t)=>e+(t.amount||0),0),i=a.reduce((e,t)=>e+(t.amount||0),0),s=n.length;return{id:e.id,name:e.name,billed:o,collected:i,pending:Math.max(0,o-i),jobs:s,rate:o>0?i/o*100:0}}).sort((e,t)=>t.billed-e.billed).slice(0,30)}catch(e){return console.error("Customer performance error:",e),[]}},g=async e=>{let{data:t,error:r}=await a.from("personnel").insert([{full_name:e.name,phone:e.phone,tc_no:e.tc,status:e.status,role:"Personel"}]).select().single();if(r)throw r;return t},_=async(e=1,t=20,r="")=>{let n=a.from("personnel").select("*",{count:"exact"});r&&(n=n.or(`full_name.ilike.%${r}%,phone.ilike.%${r}%`));let o=(e-1)*t,{data:i,error:s,count:l}=await n.order("full_name").range(o,o+t-1);if(s)throw s;return{data:i,count:l}},w=async(e=1,t=20,r="",n=null)=>{let o=a.from("work_orders").select(`
            *,
            customers (
                id,
                name,
                phone
            ),
            work_order_assignments (
                personnel_id,
                personnel (
                    id,
                    full_name
                )
            )
        `,{count:"exact"});n&&(o=o.eq("date",n)),r&&(o=o.ilike("description",`%${r}%`));let i=(e-1)*t,{data:s,error:l,count:d}=await o.order("date",{ascending:!1}).range(i,i+t-1);if(l)throw l;return{data:s?.map(e=>{let t=e.work_order_assignments||[],r=t.map(e=>e.personnel_id),a=t.map(e=>e.personnel?.full_name).filter(Boolean);return{...e,customer:e.customers?.name||"Bilinmiyor",customer_phone:e.customers?.phone||"",personnel:a.length>0?a.join(", "):"Belirsiz",amount:e.price,customerObj:e.customers,assigned_staff:r}}),count:d}},h=async(e=1,t=20,r="thisMonth",n)=>{let o=n.start,i=n.end;if("thisMonth"===r){let e=new Date;o=new Date(e.getFullYear(),e.getMonth(),1).toISOString().split("T")[0],i=new Date(e.getFullYear(),e.getMonth()+1,0).toISOString().split("T")[0]}else"allTime"===r&&(o="2020-01-01",i="2099-12-31");let{data:s}=await a.from("collections").select("*").gte("date",o).lte("date",i).order("date",{ascending:!1}).limit(1e3),{data:l}=await a.from("expenses").select("*").gte("date",o).lte("date",i).order("date",{ascending:!1}).limit(1e3),d=[...(s||[]).map(e=>({...e,type:"income",category:"Tahsilat"})),...(l||[]).map(e=>({...e,type:"expense",method:"Nakit"}))].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()),c=(e-1)*t;return{data:d.slice(c,c+t),count:d.length}},y=async(e=1,t=20,r="")=>{let n=new Date().toISOString().split("T")[0],{data:o}=await a.from("work_orders").select("customer_id, price, date").gte("date",n).eq("status","onaylandı");if(!o||0===o.length)return{data:[],count:0};let i={},s=new Set;if(o.forEach(e=>{e.customer_id&&(i[e.customer_id]||(i[e.customer_id]={pending:0,lastDate:e.date}),i[e.customer_id].pending+=e.price||0,e.date<i[e.customer_id].lastDate&&(i[e.customer_id].lastDate=e.date),s.add(e.customer_id))}),0===s.size)return{data:[],count:0};let l=Array.from(s),d=a.from("customers").select("*").in("id",l);r&&(d=d.ilike("name",`%${r}%`));let{data:c}=await d;if(!c)return{data:[],count:0};let u=c.map(e=>{let t=i[e.id];return{...e,pending:t.pending,lastTransactionDate:t.lastDate}}).sort((e,t)=>t.pending-e.pending),m=u.length,p=(e-1)*t;return{data:u.slice(p,p+t),count:m}},k=async()=>{let{data:e,error:t}=await a.from("crm_whatsapp").select("*").order("id",{ascending:!1});return t?(console.error("Error fetching CRM data:",t),[]):e},x=async e=>{let{error:t}=await a.from("crm_whatsapp").delete().eq("id",e);if(t)throw t},b=async e=>{let{data:t,error:r}=await a.from("customers").select("*").eq("id",e).single();if(r)throw r;let{data:n}=await a.from("collections").select("*").eq("customer_id",e),{data:o}=await a.from("work_orders").select("*").eq("customer_id",e),i=[...(n||[]).map(e=>({id:e.id,type:"collection",date:e.date,description:e.description||"Tahsilat",amount:e.amount,isPlus:!0})),...(o||[]).map(e=>({id:e.id,type:"work_order",date:e.date,description:e.description||"Hizmet Bedeli",amount:e.price,isPlus:!1}))].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()),s=(o||[]).reduce((e,t)=>e+(t.price||0),0),l=(n||[]).reduce((e,t)=>e+(t.amount||0),0);return{...t,history:i,current_balance:s-l}},D=async e=>{let{data:t,error:r}=await a.from("personnel").select("*").eq("id",e).single();if(r)throw r;let{data:n,error:o}=await a.from("work_order_assignments").select(`
            id,
            work_order_id,
            work_orders (
                id,
                date,
                description,
                address,
                price
            )
        `).eq("personnel_id",e).order("created_at",{ascending:!1});o&&console.error("Jobs fetch error:",o);let i=n?.map(e=>e.work_orders).filter(Boolean)||[];i.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime());let{data:s}=await a.from("payroll_records").select("*").eq("personnel_id",e).order("date",{ascending:!1}),l=(s||[]).reduce((e,t)=>e+(t.daily_wage||0),0),d=(s||[]).reduce((e,t)=>e+(t.paid_amount||0),0);return{...t,jobs:i,payroll:s||[],current_balance:l-d}},S=async(e,t=!1)=>{let[r,n,o,i]=await Promise.allSettled([a.from("personnel").select("id,full_name,role,status,current_balance").select("*").order("full_name",{ascending:!0}),a.from("payroll_records").select("id,personnel_id,daily_wage,paid_amount,description").eq("date",e),a.from("payroll_records").select("personnel_id,daily_wage,paid_amount").lt("date",e),a.from("work_orders").select("id,date,description,address,price,work_order_assignments(personnel_id,personnel(id,full_name)),customers(id,name)").eq("date",e).order("date",{ascending:!1})]),s="fulfilled"!==r.status||r.value.error?[]:r.value.data,l="fulfilled"!==n.status||n.value.error?[]:n.value.data,d="fulfilled"!==o.status||o.value.error?[]:o.value.data,c="fulfilled"!==i.status||i.value.error?[]:i.value.data,u=new Map;for(let e of d){let t=(e.daily_wage??0)-(e.paid_amount??0);u.set(e.personnel_id,(u.get(e.personnel_id)??0)+t)}let m=new Map;for(let e of l){let t=e.daily_wage??0,r=e.paid_amount??0,a=m.get(e.personnel_id)??{daily_wage:0,paid_amount:0};m.set(e.personnel_id,{daily_wage:a.daily_wage+t,paid_amount:a.paid_amount+r,recordId:e.id})}let p=new Map;for(let e of c)for(let t of e.work_order_assignments??[]){let r=t.personnel_id||t.personnel?.id;if(!r)continue;let a=p.get(r)??[];a.push(e),p.set(r,a)}let f=s.map(e=>{let t=u.get(e.id)??0,r=m.get(e.id)??{daily_wage:0,paid_amount:0},a=t+r.daily_wage-r.paid_amount,n=p.get(e.id)??[],o=n.map(e=>e.description).join(", ")||"-",i=e.full_name||e.name||"İsimsiz";return{personnel:e,carryover:t,daily_wage:r.daily_wage,paid_amount:r.paid_amount,balance_after:a,work_orders:n,id:e.id,name:i,phone:e.phone,job:o,devir:t,hakedis:r.daily_wage,odenen:r.paid_amount,bakiye:a,recordId:r.recordId}});return t&&(f=f.filter(e=>0!==e.balance_after)),f.sort((e,t)=>{let r="-"!==e.job,a="-"!==t.job;if(r&&!a)return -1;if(!r&&a)return 1;let n=0!==e.bakiye,o=0!==t.bakiye;return n&&!o?-1:!n&&o?1:(e.name||"").localeCompare(t.name||"")}),f};async function T(e){let{personnel_id:t,date:r,daily_wage:n,paid_amount:o,description:i=null}=e,s=await a.from("payroll_records").select("id").eq("personnel_id",t).eq("date",r).maybeSingle();if(s.error&&"PGRST116"!==s.error.code)return{error:s.error};let l=s.data?.id??null;if(l){let e=await a.from("payroll_records").update({daily_wage:n,paid_amount:o,description:i}).eq("id",l).select("id").single();if(e.error)return{error:e.error}}else{let e=await a.from("payroll_records").insert([{personnel_id:t,date:r,daily_wage:n,paid_amount:o,description:i}]).select("id").single();if(e.error)return{error:e.error};l=e.data.id}let d=await a.from("payroll_records").select("daily_wage,paid_amount",{count:"exact",head:!1}).eq("personnel_id",t);if(d.error)return{id:l,balanceUpdated:!1,error:d.error};let c=(d.data??[]).reduce((e,t)=>e+(t.daily_wage??0)-(t.paid_amount??0),0),u=await a.from("personnel").update({current_balance:c}).eq("id",t).select("id,current_balance").single();return u.error?{id:l,balanceUpdated:!1,error:u.error}:{id:l,balanceUpdated:!0,current_balance:u.data.current_balance}}let v=async e=>{let t=[e.date];if(e.is_recurring){console.log("Creating recurring order with params:",JSON.stringify(e,null,2));let r=new Date(e.date),a=new Date(e.date);if(e.recurring_end_date){let t=new Date(e.recurring_end_date);isNaN(t.getTime())?(console.warn("Invalid recurring_end_date provided, falling back to 3 months."),a.setMonth(a.getMonth()+3)):a=t}else a.setMonth(a.getMonth()+3);console.log("Calculated End Date:",a.toISOString());let n=new Date;if(n.setFullYear(n.getFullYear()+2),a>n&&(a=n),"once_month"===e.frequency)for(;r.setMonth(r.getMonth()+1),!(r>a);)t.push(r.toISOString().split("T")[0]);else if(["once_week","twice_week"].includes(e.frequency)){let r={Paz:0,Pzt:1,Sal:2,Çar:3,Per:4,Cum:5,Cmt:6},n=(e.recurring_days||[]).map(e=>r[e]),o=new Date(e.date);if(n.length>0)for(;o.setDate(o.getDate()+1),!(o>a);)n.includes(o.getDay())&&t.push(o.toISOString().split("T")[0]);else for(;o.setDate(o.getDate()+7),!(o>a);)t.push(o.toISOString().split("T")[0])}}let r=t.map((t,r)=>({customer_id:e.customer_id,date:t,description:e.description+(r>0?" (Tekrar)":""),address:e.address,price:e.price,personnel_count:e.personnel_count,status:"onaylanmadı"})),{data:n,error:o}=await a.from("work_orders").insert(r).select();if(o)throw o;if(e.assigned_staff&&Array.isArray(e.assigned_staff)&&e.assigned_staff.length>0){let t=n.flatMap(t=>e.assigned_staff.map(e=>({work_order_id:t.id,personnel_id:e}))),{error:r}=await a.from("work_order_assignments").insert(t);r&&console.error("Error creating assignments:",r)}return n},I=async(e,t)=>{console.log("updateWorkOrder called with:",e,t);let{data:r,error:n}=await a.from("work_orders").update({customer_id:t.customer_id,date:t.date,description:t.description,address:t.address,price:t.price,personnel_count:t.personnel_count}).eq("id",e).select().single();if(n)throw console.error("Supabase update error:",n),n;if(!r)throw Error("İş emri g\xfcncellenemedi (Kayıt bulunamadı?)");if(n)throw n;let{error:o}=await a.from("work_order_assignments").delete().eq("work_order_id",e);if(o&&console.error("Error deleting old assignments:",o),t.assigned_staff&&Array.isArray(t.assigned_staff)&&t.assigned_staff.length>0){let r=t.assigned_staff.map(t=>({work_order_id:e,personnel_id:t})),{error:n}=await a.from("work_order_assignments").insert(r);n&&console.error("Error saving new assignments:",n)}return r},j=async e=>{let{error:t}=await a.from("work_orders").update({status:"onaylandı"}).eq("id",e);if(t)throw t},M=async e=>{let{data:t,error:r}=await a.from("collections").select("*, customers(name)").eq("date",e).order("created_at",{ascending:!0});if(r)throw console.error("Collection error:",r),r;let{data:n,error:o}=await a.from("expenses").select("*").eq("date",e).order("created_at",{ascending:!0});if(o)throw console.error("Expense error:",o),o;let{data:i}=await a.from("payroll_records").select("paid_amount").eq("date",e),s=(i||[]).reduce((e,t)=>e+(t.paid_amount||0),0),{data:l}=await a.from("payroll_records").select("daily_wage, paid_amount"),d=(l||[]).reduce((e,t)=>e+((t.daily_wage||0)-(t.paid_amount||0)),0),{data:c,error:u}=await a.from("collections").select("amount").lt("date",e).in("payment_method",["nakit","Nakit","NAKİT","Cash","cash"]),{data:m,error:p}=await a.from("expenses").select("amount").lt("date",e).in("payment_method",["nakit","Nakit","NAKİT","Cash","cash"]),{data:f}=await a.from("payroll_records").select("paid_amount").lt("date",e),g=c?.reduce((e,t)=>e+(t.amount||0),0)||0;return{previousBalance:g-(m?.reduce((e,t)=>e+(t.amount||0),0)||0)-(f?.reduce((e,t)=>e+(t.paid_amount||0),0)||0),todayPaidWages:s,totalWageDebt:d,collections:t.map(e=>({id:e.id,customer_id:e.customer_id,customer:e.customers?.name||"Bilinmiyor",date:e.date,amount:e.amount,type:e.payment_method||"Nakit",payment_method:e.payment_method})),expenses:n.map(e=>({id:e.id,detail:e.description,receiptNo:e.receipt_no||e.bill_no||"",amount:e.amount,date:e.date,method:e.payment_method||"Nakit",category:e.category}))}},N=async e=>{if(!e.customer_id)throw Error("M\xfcşteri se\xe7ilmeli");let t={...e,amount:Number(e.amount)},{error:r}=await a.from("collections").insert([t]);if(r)throw console.error("Create Col Error:",r),r;return!0},q=async(e,t)=>{let{error:r}=await a.from("collections").update(t).eq("id",e);if(r)throw r;return!0},$=async e=>{let{error:t}=await a.from("collections").delete().eq("id",e);if(t)throw t;return!0},O=async e=>{let{error:t}=await a.from("expenses").insert([e]);if(t)throw t;return!0},C=async(e,t)=>{let{error:r}=await a.from("expenses").update(t).eq("id",e);if(r)throw r;return!0},E=async e=>{let{error:t}=await a.from("expenses").delete().eq("id",e);if(t)throw t;return!0},P=async(e="thisMonth",t)=>{let r=t.start,n=t.end;if("thisMonth"===e){let e=new Date;r=new Date(e.getFullYear(),e.getMonth(),1).toISOString().split("T")[0],n=new Date(e.getFullYear(),e.getMonth()+1,0).toISOString().split("T")[0]}else"allTime"===e&&(r="2020-01-01",n="2099-12-31");let{data:o}=await a.from("collections").select("amount").gte("date",r).lte("date",n),{data:i}=await a.from("expenses").select("amount").gte("date",r).lte("date",n),s=(o||[]).reduce((e,t)=>e+(t.amount||0),0),l=(i||[]).reduce((e,t)=>e+(t.amount||0),0);return{income:s,expense:l,balance:s-l}},Y=async()=>{let{data:e,error:t}=await a.from("profiles").select("*").order("full_name");if(t)throw console.error("Error fetching profiles:",t),t;return e},z=e=>{switch(e){case"Y\xf6netici":return"sistem y\xf6neticisi";case"Sekreter":return"sekreter";case"Saha Sorumlusu":return"saha sorumlusu";case"Şof\xf6r":return"şof\xf6r";case"Veri Girici":return"veri girici";default:return e?.toLowerCase()}},B=async e=>{let{data:t,error:r}=await a.from("profiles").insert([{full_name:e.name,email:e.email,role:z(e.role),phone:e.phone,status:"active"}]).select().single();if(r)throw r;return t},A=async(e,t)=>{let{data:r,error:n}=await a.from("profiles").update({full_name:t.name,email:t.email,role:z(t.role),phone:t.phone}).eq("id",e).select().single();if(n)throw n;return r},F=async e=>{let{error:t}=await a.from("profiles").delete().eq("id",e);if(t)throw t;return!0}},429:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>o,__esModule:()=>n,default:()=>i});let a=(0,r(6843).createProxy)(String.raw`/Users/taneryildirim/Desktop/ucanlarfinal/app/error.tsx`),{__esModule:n,$$typeof:o}=a,i=a.default},1146:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>i});let a=(0,r(6843).createProxy)(String.raw`/Users/taneryildirim/Desktop/ucanlarfinal/app/global-error.tsx`),{__esModule:n,$$typeof:o}=a,i=a.default},2917:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l,metadata:()=>s});var a=r(5036),n=r(8592),o=r.n(n);r(7272);var i=r(7171);let s={title:"U\xe7anlar Temizlik Y\xf6netim Paneli",description:"U\xe7anlar Temizlik Hizmetleri Y\xf6netim Sistemi"};function l({children:e}){return a.jsx("html",{lang:"tr",children:(0,a.jsxs)("body",{className:o().className,children:[e,a.jsx(i.x7,{position:"top-right"})]})})}},1429:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var a=r(5036),n=r(6274);function o(){return(0,a.jsxs)("div",{className:"flex h-[50vh] flex-col items-center justify-center gap-4 text-center",children:[a.jsx("h2",{className:"text-4xl font-bold text-slate-800",children:"404"}),a.jsx("p",{className:"text-lg text-slate-600",children:"Sayfa bulunamadı"}),a.jsx(n.default,{href:"/",className:"rounded-lg bg-blue-600 px-4 py-2 text-white transition-colors hover:bg-blue-700",children:"Ana Sayfaya D\xf6n"})]})}},7272:()=>{}};