(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[29],{1926:function(e,t,s){Promise.resolve().then(s.bind(s,9972))},9972:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var l=s(3827),a=s(1232),n=s(94),r=s(8670),i=s(7841),c=s(7731),o=s(489),d=s(9108),u=s(7805),x=s(1657),m=s(4090),h=s(8792),f=s(2235),p=s(9807),b=s(6288);function y(e){let{isOpen:t,onClose:s,initialData:a,onSuccess:n}=e,[r,i]=(0,m.useState)(!1),[c,o]=(0,m.useState)(""),[d,u]=(0,m.useState)(""),[x,h]=(0,m.useState)(""),[y,j]=(0,m.useState)("Aktif");(0,m.useEffect)(()=>{t&&(o((null==a?void 0:a.full_name)||(null==a?void 0:a.name)||""),u((null==a?void 0:a.phone)||""),h((null==a?void 0:a.tc_no)||(null==a?void 0:a.tc)||""),j((null==a?void 0:a.status)||"Aktif"))},[a,t]);let N=async()=>{if(!c){b.toast.error("Ad soyad zorunludur.");return}i(!0);try{let e=await (0,p.pU)({name:c,phone:d,tc:x,status:y});b.toast.success("Personel başarıyla oluşturuldu."),n&&n(e),s()}catch(e){console.error(e),b.toast.error("Hata: ".concat(e.message))}finally{i(!1)}};return t?(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 backdrop-blur-sm p-4",children:(0,l.jsxs)("div",{className:"w-full max-w-lg rounded-xl bg-white shadow-2xl animate-in fade-in zoom-in duration-200",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between border-b border-slate-100 p-6",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-900",children:a?"Personel D\xfczenle":"Yeni Personel Ekle"}),(0,l.jsx)("button",{onClick:s,className:"rounded-lg p-2 text-slate-400 hover:bg-slate-50 hover:text-slate-600 transition-colors",children:(0,l.jsx)(f.Z,{className:"h-5 w-5"})})]}),(0,l.jsxs)("div",{className:"p-6 space-y-6",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("label",{className:"text-sm font-bold text-slate-900",children:["Ad Soyad ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"text",value:c,onChange:e=>o(e.target.value),placeholder:"Ad soyad girin...",className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-bold text-slate-900",children:"Telefon"}),(0,l.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),placeholder:"Telefon numarası...",className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-bold text-slate-900",children:"TC Kimlik No"}),(0,l.jsx)("input",{type:"text",value:x,onChange:e=>h(e.target.value),placeholder:"TC kimlik numarası...",className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-bold text-slate-900",children:"Durum"}),(0,l.jsxs)("select",{value:y,onChange:e=>j(e.target.value),className:"w-full appearance-none rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10",children:[(0,l.jsx)("option",{value:"Aktif",children:"Aktif"}),(0,l.jsx)("option",{value:"Pasif",children:"Pasif"})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-3 border-t border-slate-100 p-6 rounded-b-xl",children:[(0,l.jsx)("button",{onClick:s,disabled:r,className:"rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-50 disabled:opacity-50",children:"İptal"}),(0,l.jsxs)("button",{onClick:N,disabled:r,className:"rounded-lg bg-blue-600 px-6 py-2 text-sm font-medium text-white hover:bg-blue-700 shadow-md shadow-blue-200 disabled:opacity-50 flex items-center gap-2",children:[r&&(0,l.jsx)("div",{className:"h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Kaydet"]})]})]})}):null}function j(){let[e,t]=(0,m.useState)(!1),[s,f]=(0,m.useState)([]),[b,j]=(0,m.useState)(null),[N,g]=(0,m.useState)(1),[v]=(0,m.useState)(10),[k,w]=(0,m.useState)(0),[Z,C]=(0,m.useState)(""),[S,z]=(0,m.useState)(!0);async function M(){z(!0);try{let{data:e,count:t}=await (0,p.sE)(N,v,Z);f(e||[]),w(t||0)}catch(e){console.error("Error fetching personnel:",e)}finally{z(!1)}}(0,m.useEffect)(()=>{let e=setTimeout(()=>{M()},300);return()=>clearTimeout(e)},[N,Z]);let I=async e=>{if(confirm("Bu personeli silmek istediğinize emin misiniz?"))try{let{error:t}=await p.OQ.from("personnel").delete().eq("id",e);if(t)throw t;M()}catch(e){console.error("Delete error",e),alert("Silme işlemi başarısız oldu.")}},A=e=>{j(e),t(!0)},P=Math.ceil(k/v);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.h,{title:"Personel"}),(0,l.jsxs)("div",{className:"p-8 space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Personel"}),(0,l.jsxs)("button",{onClick:()=>{j(null),t(!0)},className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 font-medium text-white transition-colors hover:bg-blue-700 shadow-md shadow-blue-200",children:[(0,l.jsx)(n.Z,{className:"h-4 w-4"}),"Yeni Personel"]})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm p-6",children:[(0,l.jsxs)("div",{className:"mb-6 max-w-md relative",children:[(0,l.jsx)(r.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),(0,l.jsx)("input",{type:"text",value:Z,onChange:e=>{C(e.target.value),g(1)},placeholder:"İsim veya telefon ile ara...",className:"w-full rounded-lg border border-slate-200 py-2.5 pl-10 pr-4 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10"})]}),(0,l.jsx)("div",{className:"overflow-x-auto min-h-[300px]",children:(0,l.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,l.jsx)("thead",{className:"text-slate-500 border-b border-slate-100",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-4 font-medium",children:"Personel Adı"}),(0,l.jsx)("th",{className:"px-4 py-4 font-medium",children:"Telefon"}),(0,l.jsx)("th",{className:"px-4 py-4 font-medium",children:"TC No"}),(0,l.jsx)("th",{className:"px-4 py-4 font-medium",children:"Durum"}),(0,l.jsx)("th",{className:"px-4 py-4 text-center font-medium",children:"İşlemler"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-slate-100",children:S?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:5,className:"p-8 text-center text-slate-500",children:"Y\xfckleniyor..."})}):0===s.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:5,className:"p-8 text-center text-slate-500",children:"Kayıt bulunamadı."})}):s.map(e=>(0,l.jsxs)("tr",{className:"group hover:bg-slate-50/50 transition-colors",children:[(0,l.jsx)("td",{className:"px-4 py-4 font-bold text-slate-800 uppercase text-xs",children:e.full_name||e.name}),(0,l.jsx)("td",{className:"px-4 py-4 font-medium text-slate-900 text-xs",children:e.phone}),(0,l.jsx)("td",{className:"px-4 py-4 text-slate-600 font-mono text-xs",children:e.tc_no||e.tc}),(0,l.jsx)("td",{className:"px-4 py-4",children:(0,l.jsx)("span",{className:(0,x.cn)("inline-block rounded px-2 py-0.5 text-[10px] font-bold border","Aktif"===e.status?"bg-green-100 text-green-700 border-green-200":"bg-slate-100 text-slate-700 border-slate-200"),children:e.status||"Aktif"})}),(0,l.jsx)("td",{className:"px-4 py-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,l.jsx)(h.default,{href:"/personel/".concat(e.id),className:"rounded p-1.5 text-slate-400 hover:bg-slate-100 hover:text-blue-600 transition-colors",title:"Detay",children:(0,l.jsx)(i.Z,{className:"h-4 w-4"})}),(0,l.jsx)("button",{onClick:()=>A(e),className:"rounded p-1.5 text-slate-400 hover:bg-amber-50 hover:text-amber-600 transition-colors",title:"D\xfczenle",children:(0,l.jsx)(c.Z,{className:"h-4 w-4"})}),(0,l.jsx)("button",{onClick:()=>I(e.id),className:"rounded p-1.5 text-slate-400 hover:bg-red-50 hover:text-red-600 transition-colors",title:"Sil",children:(0,l.jsx)(o.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})}),P>1&&(0,l.jsxs)("div",{className:"mt-4 flex items-center justify-between border-t border-slate-100 pt-4",children:[(0,l.jsxs)("div",{className:"text-sm text-slate-500",children:["Toplam ",k," kayıt, Sayfa ",N," / ",P]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)("button",{onClick:()=>g(e=>Math.max(1,e-1)),disabled:1===N,className:"flex items-center gap-1 rounded px-3 py-1.5 text-sm font-medium hover:bg-slate-100 disabled:opacity-50",children:[(0,l.jsx)(d.Z,{className:"h-4 w-4"})," \xd6nceki"]}),(0,l.jsxs)("button",{onClick:()=>g(e=>Math.min(P,e+1)),disabled:N===P,className:"flex items-center gap-1 rounded px-3 py-1.5 text-sm font-medium hover:bg-slate-100 disabled:opacity-50",children:["Sonraki ",(0,l.jsx)(u.Z,{className:"h-4 w-4"})]})]})]})]})]}),(0,l.jsx)(y,{isOpen:e,onClose:()=>{t(!1),M()},initialData:b})]})}},1232:function(e,t,s){"use strict";s.d(t,{h:function(){return x}});var l=s(3827),a=s(9108),n=s(1213),r=s(1049),i=s(8458),c=s(7907),o=s(8792),d=s(6288),u=s(5838);function x(e){let{title:t}=e,s=(0,c.useRouter)(),x=(0,c.usePathname)(),m=(0,i.e)(),{role:h,profile:f,loading:p}=(0,u.j)(),b=async()=>{try{await m.auth.signOut(),d.toast.success("\xc7ıkış yapıldı"),s.push("/login"),s.refresh()}catch(e){d.toast.error("\xc7ıkış yapılırken hata oluştu")}};return(0,l.jsxs)("header",{className:"flex h-20 items-center justify-between border-b bg-white px-4 md:px-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"md:hidden",children:"/"!==x&&(0,l.jsx)(o.default,{href:"/",className:"flex items-center justify-center p-2 -ml-2 text-slate-600 hover:bg-slate-100 rounded-full",children:(0,l.jsx)(a.Z,{className:"h-6 w-6"})})}),(0,l.jsx)("h2",{className:"text-lg md:text-xl font-bold text-slate-800 truncate max-w-[200px] md:max-w-none",children:t||"Y\xf6netim Paneli"})]}),(0,l.jsx)("div",{className:"flex items-center gap-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-3 rounded-full border border-slate-200 bg-slate-50 p-1 pl-4 pr-2",children:[(0,l.jsx)("div",{className:"flex flex-col items-end",children:p?(0,l.jsx)("span",{className:"text-xs text-slate-400",children:"Y\xfckleniyor..."}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"text-sm font-semibold text-slate-900",children:(null==f?void 0:f.full_name)||(null==f?void 0:f.name)||(null==f?void 0:f.email)||"Kullanıcı"}),(0,l.jsx)("span",{className:"text-xs text-slate-500 capitalize",children:h||"Yetkisiz"})]})}),(0,l.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-slate-200 text-slate-600",children:(0,l.jsx)(n.Z,{className:"h-5 w-5"})}),(0,l.jsx)("button",{onClick:b,className:"ml-2 rounded-full p-2 text-slate-400 hover:bg-slate-200 hover:text-slate-600 transition-colors",title:"\xc7ıkış Yap",children:(0,l.jsx)(r.Z,{className:"h-5 w-5"})})]})})]})}},5838:function(e,t,s){"use strict";s.d(t,{j:function(){return n}});var l=s(4090),a=s(8458);function n(){let[e,t]=(0,l.useState)(null),[s,n]=(0,l.useState)(null),[r,i]=(0,l.useState)(!0),c=(0,a.e)();return(0,l.useEffect)(()=>{(async function(){try{let{data:{user:e}}=await c.auth.getUser();if(e){let{data:s}=await c.from("profiles").select("*").eq("id",e.id).single();s&&(t(s.role),n(s))}}catch(e){console.error("Error fetching role:",e)}finally{i(!1)}})()},[]),{role:e,profile:s,loading:r}}},1657:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var l=s(3167),a=s(1367);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,l.W)(t))}},9108:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},7805:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},7841:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},1049:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},7731:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]])},94:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},8670:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},489:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},1213:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2235:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},8458:function(e,t,s){"use strict";s.d(t,{e:function(){return a}});var l=s(6070);function a(){return(0,l.createBrowserClient)("https://rzcumzfzurthasgptggd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ6Y3VtemZ6dXJ0aGFzZ3B0Z2dkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYxNDA5MzYsImV4cCI6MjA4MTcxNjkzNn0.NlyDKeMj-4xa7ZSt5wsyRdCOay8w2SAIA-ZTjIRkyHw")}}},function(e){e.O(0,[257,288,250,224,807,971,69,744],function(){return e(e.s=1926)}),_N_E=e.O()}]);