(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[558],{5543:function(e,t,s){Promise.resolve().then(s.bind(s,7557))},7557:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var n=s(3827),a=s(4090),l=s(1232),r=s(8670),i=s(7307),o=s(7211),c=s(8994),d=s(1657),u=s(2235),x=s(699),m=s(5838),h=s(7220);function p(e){let{isOpen:t,onClose:s,initialData:l,onSave:r}=e,{role:i}=(0,m.j)(),o=(0,h.Fs)(i||void 0,h._I.CAN_MANAGE_ACCRUALS),[c,p]=(0,a.useState)({devir:0,hakedis:0,odenen:0,bakiye:0});(0,a.useEffect)(()=>{l&&p({devir:l.devir||0,hakedis:l.hakedis||0,odenen:l.odenen||0,bakiye:l.bakiye||0})},[l]),(0,a.useEffect)(()=>{let e=Number(c.devir)+Number(c.hakedis)-Number(c.odenen);p(t=>({...t,bakiye:e}))},[c.devir,c.hakedis,c.odenen]);let b=e=>{let{name:t,value:s}=e.target;p(e=>({...e,[t]:Number(s)}))};return t?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,n.jsxs)("div",{className:"w-full max-w-lg bg-white rounded-xl shadow-2xl animate-in fade-in zoom-in duration-200",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between border-b p-4",children:[(0,n.jsxs)("h2",{className:"text-lg font-bold text-slate-900",children:["Yevmiye D\xfczenle - ",null==l?void 0:l.name]}),(0,n.jsx)("button",{onClick:s,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:(0,n.jsx)(u.Z,{className:"h-5 w-5 text-slate-500"})})]}),(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r({...l,...c}),s()},className:"p-8 space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"D\xfcnden Devir"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:"number",name:"devir",value:0===c.devir?"":c.devir,placeholder:"0",onChange:b,className:"w-full rounded-lg border border-slate-200 py-3 px-4 text-sm font-bold text-slate-600 bg-slate-50 outline-none focus:border-blue-500 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"}),(0,n.jsx)("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:"₺"})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Bug\xfcn Hakediş"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:"number",name:"hakedis",value:0===c.hakedis?"":c.hakedis,placeholder:"0",onChange:b,disabled:!o,className:(0,d.cn)("w-full rounded-lg border border-slate-200 py-3 px-4 text-sm font-bold text-slate-900 outline-none focus:border-blue-500 bg-green-50/50 border-green-200 focus:border-green-500 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",!o&&"opacity-50 cursor-not-allowed bg-slate-100 border-slate-200 text-slate-500")}),(0,n.jsx)("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:"₺"})]}),!o&&(0,n.jsx)("p",{className:"text-xs text-red-500 mt-1",children:"Yetkiniz yok."})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Bug\xfcn \xd6denen"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:"number",name:"odenen",value:0===c.odenen?"":c.odenen,placeholder:"0",onChange:b,className:"w-full rounded-lg border border-slate-200 py-3 px-4 text-sm font-bold text-slate-900 outline-none focus:border-blue-500 bg-red-50/50 border-red-200 focus:border-red-500 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"}),(0,n.jsx)("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:"₺"})]})]})]}),(0,n.jsx)("div",{className:"pt-6 border-t border-slate-100",children:(0,n.jsxs)("div",{className:"flex justify-between items-center bg-slate-50 p-5 rounded-lg border border-slate-200",children:[(0,n.jsx)("span",{className:"font-bold text-slate-700",children:"Yeni Bakiye"}),(0,n.jsxs)("span",{className:(0,d.cn)("text-2xl font-black",c.bakiye>0?"text-red-600":"text-green-600"),children:["₺",c.bakiye.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]})}),(0,n.jsxs)("div",{className:"pt-6 flex justify-end gap-3",children:[(0,n.jsx)("button",{type:"button",onClick:s,className:"px-6 py-2.5 text-sm font-bold text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:"İptal"}),(0,n.jsxs)("button",{type:"submit",className:"flex items-center gap-2 px-8 py-2.5 text-sm font-bold text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors shadow-sm shadow-blue-200",children:[(0,n.jsx)(x.Z,{className:"h-4 w-4"}),"Kaydet"]})]})]})]})}):null}var b=s(9807),f=s(6288);function y(){let[e,t]=(0,a.useState)([]),[s,u]=(0,a.useState)(!0),[x,m]=(0,a.useState)(null),[h,y]=(0,a.useState)(!1),[g,j]=(0,a.useState)(""),[N,v]=(0,a.useState)(new Date().toISOString().split("T")[0]),[k,w]=(0,a.useState)(!1);async function S(){u(!0);try{let e=await (0,b.Es)(N,k);t(e)}catch(e){console.error("Error fetching wages:",e),f.toast.error("Veriler y\xfcklenirken hata oluştu.")}finally{u(!1)}}(0,a.useEffect)(()=>{S()},[N,k]);let Z=e.filter(e=>e.name.toLowerCase().includes(g.toLowerCase())),A=e=>{m(e),y(!0)},C=async e=>{try{await (0,b.xl)({personnel_id:e.id,date:N,daily_wage:e.hakedis,paid_amount:e.odenen,carryover_balance:e.devir,description:e.description}),f.toast.success("Kayıt g\xfcncellendi."),y(!1),m(null),S()}catch(e){console.error("Error saving wage:",e),f.toast.error("Kaydetme başarısız.")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.h,{title:"Personel Yevmiye"}),(0,n.jsxs)("div",{className:"p-8 space-y-6",children:[(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Personel Yevmiye"})}),(0,n.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm p-6",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-4 mb-6 md:flex-row md:items-center",children:[(0,n.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,n.jsx)(r.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),(0,n.jsx)("input",{type:"text",value:g,onChange:e=>j(e.target.value),placeholder:"İsim ile ara...",className:"w-full rounded-lg border border-slate-200 py-2.5 pl-10 pr-4 text-sm outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/10"})]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:"date",value:N,onChange:e=>v(e.target.value),className:"pl-10 pr-4 py-2.5 rounded-lg border border-slate-200 text-sm font-medium text-slate-700 outline-none focus:border-blue-500 cursor-pointer"}),(0,n.jsx)(i.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-500 pointer-events-none"})]}),(0,n.jsxs)("button",{onClick:()=>w(!k),className:(0,d.cn)("flex items-center gap-2 rounded-lg border px-4 py-2.5 text-sm font-medium transition-colors",k?"bg-blue-50 border-blue-200 text-blue-700":"bg-white border-slate-200 text-slate-700 hover:bg-slate-50"),children:[(0,n.jsx)(o.Z,{className:"h-4 w-4"}),"Bakiyesi Olanlar"]})]}),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,n.jsx)("thead",{className:"text-slate-500 border-b border-slate-100",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-4 py-4 font-medium",children:"Ad Soyad"}),(0,n.jsx)("th",{className:"px-4 py-4 font-medium",children:"Telefon"}),(0,n.jsx)("th",{className:"px-4 py-4 font-medium",children:"Bug\xfcn \xc7alıştığı İş"}),(0,n.jsx)("th",{className:"px-4 py-4 font-bold text-slate-700 text-right",children:"Devir"}),(0,n.jsx)("th",{className:"px-4 py-4 font-bold text-slate-700 text-right",children:"Hakediş"}),(0,n.jsx)("th",{className:"px-4 py-4 font-bold text-slate-700 text-right",children:"\xd6denen"}),(0,n.jsx)("th",{className:"px-4 py-4 font-bold text-slate-700 text-right",children:"Bakiye"}),(0,n.jsx)("th",{className:"px-4 py-4 text-center font-medium",children:"İşlem"})]})}),(0,n.jsx)("tbody",{className:"divide-y divide-slate-100",children:s?(0,n.jsx)("tr",{children:(0,n.jsxs)("td",{colSpan:8,className:"text-center py-12 text-slate-500",children:[(0,n.jsx)(c.Z,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),"Y\xfckleniyor..."]})}):0===Z.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:8,className:"text-center py-12 text-slate-500",children:"Kayıt bulunamadı."})}):Z.map(e=>(0,n.jsxs)("tr",{className:"group hover:bg-slate-50/50 transition-colors",children:[(0,n.jsx)("td",{className:"px-4 py-4 font-bold text-slate-800 uppercase text-xs",children:e.name}),(0,n.jsx)("td",{className:"px-4 py-4 font-medium text-slate-900 text-xs",children:e.phone||"-"}),(0,n.jsx)("td",{className:"px-4 py-4 text-slate-600 text-xs",children:e.job}),(0,n.jsxs)("td",{className:"px-4 py-4 text-right font-bold text-slate-600",children:["₺",e.devir.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,n.jsxs)("td",{className:"px-4 py-4 text-right font-bold text-green-600",children:["₺",e.hakedis.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,n.jsxs)("td",{className:"px-4 py-4 text-right font-bold text-red-600",children:["₺",e.odenen.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,n.jsxs)("td",{className:(0,d.cn)("px-4 py-4 text-right font-black",e.bakiye>0?"text-red-700":"text-slate-900"),children:["₺",e.bakiye.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,n.jsx)("td",{className:"px-4 py-4 text-center",children:(0,n.jsx)("button",{onClick:()=>A(e),className:"rounded border border-slate-200 px-3 py-1 text-xs font-bold text-slate-700 hover:bg-slate-50 transform active:scale-95 transition-all",children:"D\xfczenle"})})]},e.id))})]})})]})]}),(0,n.jsx)(p,{isOpen:h,onClose:()=>y(!1),initialData:x,onSave:C})]})}},1232:function(e,t,s){"use strict";s.d(t,{h:function(){return x}});var n=s(3827),a=s(9108),l=s(1213),r=s(1049),i=s(8458),o=s(7907),c=s(8792),d=s(6288),u=s(5838);function x(e){let{title:t}=e,s=(0,o.useRouter)(),x=(0,o.usePathname)(),m=(0,i.e)(),{role:h,profile:p,loading:b}=(0,u.j)(),f=async()=>{try{await m.auth.signOut(),d.toast.success("\xc7ıkış yapıldı"),s.push("/login"),s.refresh()}catch(e){d.toast.error("\xc7ıkış yapılırken hata oluştu")}};return(0,n.jsxs)("header",{className:"flex h-20 items-center justify-between border-b bg-white px-4 md:px-8",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"md:hidden",children:"/"!==x&&(0,n.jsx)(c.default,{href:"/",className:"flex items-center justify-center p-2 -ml-2 text-slate-600 hover:bg-slate-100 rounded-full",children:(0,n.jsx)(a.Z,{className:"h-6 w-6"})})}),(0,n.jsx)("h2",{className:"text-lg md:text-xl font-bold text-slate-800 truncate max-w-[200px] md:max-w-none",children:t||"Y\xf6netim Paneli"})]}),(0,n.jsx)("div",{className:"flex items-center gap-4",children:(0,n.jsxs)("div",{className:"flex items-center gap-3 rounded-full border border-slate-200 bg-slate-50 p-1 pl-4 pr-2",children:[(0,n.jsx)("div",{className:"flex flex-col items-end",children:b?(0,n.jsx)("span",{className:"text-xs text-slate-400",children:"Y\xfckleniyor..."}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"text-sm font-semibold text-slate-900",children:(null==p?void 0:p.full_name)||(null==p?void 0:p.name)||(null==p?void 0:p.email)||"Kullanıcı"}),(0,n.jsx)("span",{className:"text-xs text-slate-500 capitalize",children:h||"Yetkisiz"})]})}),(0,n.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-slate-200 text-slate-600",children:(0,n.jsx)(l.Z,{className:"h-5 w-5"})}),(0,n.jsx)("button",{onClick:f,className:"ml-2 rounded-full p-2 text-slate-400 hover:bg-slate-200 hover:text-slate-600 transition-colors",title:"\xc7ıkış Yap",children:(0,n.jsx)(r.Z,{className:"h-5 w-5"})})]})})]})}},5838:function(e,t,s){"use strict";s.d(t,{j:function(){return l}});var n=s(4090),a=s(8458);function l(){let[e,t]=(0,n.useState)(null),[s,l]=(0,n.useState)(null),[r,i]=(0,n.useState)(!0),o=(0,a.e)();return(0,n.useEffect)(()=>{(async function(){try{let{data:{user:e}}=await o.auth.getUser();if(e){let{data:s}=await o.from("profiles").select("*").eq("id",e.id).single();s&&(t(s.role),l(s))}}catch(e){console.error("Error fetching role:",e)}finally{i(!1)}})()},[]),{role:e,profile:s,loading:r}}},7220:function(e,t,s){"use strict";s.d(t,{Fs:function(){return i},_I:function(){return l},mn:function(){return r}});let n={ADMIN:"sistem y\xf6neticisi",DATA_ENTRY:"veri girici",FIELD_SUPERVISOR:"saha sorumlusu",DRIVER:"şof\xf6r"},a={[n.ADMIN]:["*"],[n.DATA_ENTRY]:["*","!/kullanicilar"],[n.FIELD_SUPERVISOR]:["*","!/raporlama","!/gelir-gider","!/kullanicilar"],[n.DRIVER]:["/gunluk-program","/login"]},l={CAN_DELETE:[n.ADMIN],CAN_APPROVE_WORK_ORDER:[n.ADMIN,n.DATA_ENTRY],CAN_MANAGE_ACCRUALS:[n.ADMIN,n.DATA_ENTRY]};function r(e,t){if(!e)return!1;if("/"===t||"/login"===t)return!0;let s=t.split("?")[0],n=a[e];return!!n&&(n.includes("*")?!n.filter(e=>e.startsWith("!")).map(e=>e.substring(1)).some(e=>s.startsWith(e)):n.some(e=>s.startsWith(e)))}function i(e,t){return!!e&&t.includes(e)}},1657:function(e,t,s){"use strict";s.d(t,{cn:function(){return l}});var n=s(3167),a=s(1367);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,n.W)(t))}},7307:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(7461).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},9108:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(7461).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},7211:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(7461).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},8994:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(7461).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1049:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(7461).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},699:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(7461).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},8670:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(7461).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},1213:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(7461).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2235:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(7461).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},8458:function(e,t,s){"use strict";s.d(t,{e:function(){return a}});var n=s(6070);function a(){return(0,n.createBrowserClient)("https://rzcumzfzurthasgptggd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ6Y3VtemZ6dXJ0aGFzZ3B0Z2dkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYxNDA5MzYsImV4cCI6MjA4MTcxNjkzNn0.NlyDKeMj-4xa7ZSt5wsyRdCOay8w2SAIA-ZTjIRkyHw")}}},function(e){e.O(0,[257,288,250,224,807,971,69,744],function(){return e(e.s=5543)}),_N_E=e.O()}]);