(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[71],{224:function(e,l,r){Promise.resolve().then(r.bind(r,5197))},5197:function(e,l,r){"use strict";r.r(l),r.d(l,{default:function(){return u}});var s=r(3827),i=r(4090),t=r(8458),n=r(8994),a=r(7976),o=r(7461);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,o.Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),d=(0,o.Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function u(){var e,l,r,o;let u=(0,t.e)(),[m,x]=(0,i.useState)({loading:!0,user:null,profile:null,collectionsCheck:null,profileError:null,collectionsError:null});return((0,i.useEffect)(()=>{(async function(){let e={},{data:{user:l},error:r}=await u.auth.getUser();if(e.user=l,e.authError=r,l){let{data:r,error:s}=await u.from("profiles").select("*").eq("id",l.id).single();e.profile=r,e.profileError=s;let{data:i,error:t,count:n}=await u.from("collections").select("*",{count:"exact",head:!1}).limit(1);e.collectionsCheck=i,e.collectionsCount=n,e.collectionsError=t}x({...e,loading:!1})})()},[]),m.loading)?(0,s.jsxs)("div",{className:"flex h-screen items-center justify-center",children:[(0,s.jsx)(n.Z,{className:"h-8 w-8 animate-spin text-blue-500"}),(0,s.jsx)("span",{className:"ml-2",children:"Sistem kontrol ediliyor..."})]}):(0,s.jsxs)("div",{className:"p-8 space-y-6 max-w-4xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"RLS Debug Ekranı"}),(0,s.jsxs)("div",{className:"border p-4 rounded-lg bg-white shadow-sm",children:[(0,s.jsxs)("h2",{className:"font-semibold text-lg mb-2 flex items-center gap-2",children:["1. Oturum Durumu",m.user?(0,s.jsx)(a.Z,{className:"text-green-500"}):(0,s.jsx)(c,{className:"text-red-500"})]}),(0,s.jsxs)("div",{className:"bg-slate-100 p-3 rounded text-xs font-mono overflow-auto",children:[m.user?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:["User ID: ",m.user.id]}),(0,s.jsxs)("p",{children:["Email: ",m.user.email]}),(0,s.jsxs)("p",{children:["Last Sign In: ",m.user.last_sign_in_at]})]}):(0,s.jsx)("p",{className:"text-red-500",children:"Kullanıcı oturumu bulunamadı. L\xfctfen giriş yapın."}),m.authError&&(0,s.jsx)("p",{className:"text-red-500 mt-2",children:JSON.stringify(m.authError)})]})]}),(0,s.jsxs)("div",{className:"border p-4 rounded-lg bg-white shadow-sm",children:[(0,s.jsxs)("h2",{className:"font-semibold text-lg mb-2 flex items-center gap-2",children:["2. Profil Tablosu (profiles)",m.profile?(0,s.jsx)(a.Z,{className:"text-green-500"}):(0,s.jsx)(d,{className:"text-yellow-500"})]}),(0,s.jsxs)("p",{className:"text-sm text-slate-500 mb-2",children:["RLS politikaları bu tablodaki ",(0,s.jsx)("strong",{children:"role"})," alanına g\xf6re \xe7alışır."]}),(0,s.jsx)("div",{className:"bg-slate-100 p-3 rounded text-xs font-mono overflow-auto",children:m.profile?(0,s.jsx)("pre",{children:JSON.stringify(m.profile,null,2)}):(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-red-500 font-bold",children:"Profil bulunamadı veya erişilemedi!"}),(0,s.jsx)("p",{children:"Bu, RLS politikalarının \xe7alışmamasına neden olur."}),m.profileError&&(0,s.jsxs)("p",{className:"text-red-500 mt-2",children:["Hata: ",JSON.stringify(m.profileError)]})]})})]}),(0,s.jsxs)("div",{className:"border p-4 rounded-lg bg-white shadow-sm",children:[(0,s.jsxs)("h2",{className:"font-semibold text-lg mb-2 flex items-center gap-2",children:["3. Veri Erişimi Testi (Collections)",m.collectionsError?(0,s.jsx)(c,{className:"text-red-500"}):(0,s.jsx)(a.Z,{className:"text-green-500"})]}),(0,s.jsx)("div",{className:"bg-slate-100 p-3 rounded text-xs font-mono overflow-auto",children:m.collectionsError?(0,s.jsxs)("p",{className:"text-red-500",children:["Hata: ",JSON.stringify(m.collectionsError)]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Sorgu başarılı."}),(0,s.jsxs)("p",{children:["D\xf6nen Kayıt Sayısı: ",null===(e=m.collectionsCheck)||void 0===e?void 0:e.length]}),(0,s.jsxs)("p",{children:["Toplam Count: ",m.collectionsCount]}),(null===(l=m.collectionsCheck)||void 0===l?void 0:l.length)===0&&(0,s.jsxs)("p",{className:"text-yellow-600 mt-2",children:["Uyarı: 0 kayıt d\xf6nd\xfc. Eğer tabloda veri varsa, RLS politikanız verileri gizliyor demektir. Rol\xfcn\xfcz\xfcn (",null===(r=m.profile)||void 0===r?void 0:r.role,") bu tabloyu g\xf6rme yetkisi olduğundan emin olun."]})]})})]}),(0,s.jsxs)("div",{className:"bg-blue-50 p-4 rounded text-sm text-blue-800",children:[(0,s.jsx)("strong",{children:"İpucu:"})," Eğer 2. adımda profil verisi geliyor ama 3. adımda veri gelmiyorsa,",(0,s.jsx)("code",{children:"role"}),' alanındaki değerin (\xf6rn: "',null===(o=m.profile)||void 0===o?void 0:o.role,'") veritabanındaki RLS politikasında yazan değerle (\xf6rn: "sistem y\xf6neticisi")',(0,s.jsx)("strong",{children:"birebir aynı"})," (boşluklar, harf duyarlılığı) olduğunu kontrol edin."]})]})}},7976:function(e,l,r){"use strict";r.d(l,{Z:function(){return s}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(7461).Z)("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},8994:function(e,l,r){"use strict";r.d(l,{Z:function(){return s}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(7461).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},8458:function(e,l,r){"use strict";r.d(l,{e:function(){return i}});var s=r(6070);function i(){return(0,s.createBrowserClient)("https://rzcumzfzurthasgptggd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ6Y3VtemZ6dXJ0aGFzZ3B0Z2dkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYxNDA5MzYsImV4cCI6MjA4MTcxNjkzNn0.NlyDKeMj-4xa7ZSt5wsyRdCOay8w2SAIA-ZTjIRkyHw")}}},function(e){e.O(0,[257,971,69,744],function(){return e(e.s=224)}),_N_E=e.O()}]);