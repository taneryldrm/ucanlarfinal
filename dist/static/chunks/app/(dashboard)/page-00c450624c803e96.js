(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[130],{9980:function(e,t,s){Promise.resolve().then(s.bind(s,6436))},6436:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var l=s(3827),a=s(1232),n=s(94),i=s(9733),r=s(7252),d=s(527),c=s(8670),o=s(1657),m=s(8792),x=s(4090),u=s(7907),h=s(9807),f=s(5838),b=s(7220),p=s(7147);function j(){let[e,t]=(0,x.useState)(""),[s,j]=(0,x.useState)([]),[g,N]=(0,x.useState)({totalIncome:0,totalExpense:0,netProfit:0,pendingCollection:0}),[v,y]=(0,x.useState)([]),[w,k]=(0,x.useState)(!0),{role:D}=(0,f.j)(),Z=(0,u.useRouter)(),T=(0,x.useRef)(null),S="şof\xf6r"===D;(0,x.useEffect)(()=>{async function e(){try{if(S){k(!1);return}let[e,t]=await Promise.all([(0,h.z2)(),(0,h._H)()]);if(e.data&&N(e.data),t&&t.data){let e=t.data,s=[],l=new Date;for(let t=0;t<10;t++){let a=new Date(l);a.setDate(l.getDate()+t);let n=e[a.toISOString().split("T")[0]]||[],i=new Set;n.forEach(e=>{e.work_order_assignments&&e.work_order_assignments.forEach(e=>{var t;e.personnel_id?i.add(e.personnel_id):(null===(t=e.personnel)||void 0===t?void 0:t.id)&&i.add(e.personnel.id)})}),s.push({id:t,day:a.getDate(),date:a.toLocaleDateString("tr-TR",{day:"numeric",month:"long",weekday:"long"}),jobs:n.length,personnel:i.size,isToday:0===t})}y(s)}}catch(e){console.error("Dashboard data load error:",e)}finally{k(!1)}}null!==D&&e()},[D,S]),(0,x.useEffect)(()=>{function e(e){T.current&&!T.current.contains(e.target)&&j([])}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let _=async e=>{let s=e.target.value;t(s),s.length>2?j((await (0,h.p8)(s)).filter(e=>"M\xfcşteri"===e.source).map(e=>({id:e.id,name:e.name,phone:e.description.split("|")[0].replace("Telefon:","").trim()}))):j([])};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.h,{title:"Y\xf6netim Paneli"}),(0,l.jsxs)("div",{className:(0,o.cn)("p-4",S?"block":"block md:hidden"),children:[(0,l.jsx)("div",{className:"mb-6 flex items-center justify-between",children:(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Men\xfc"})}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-4",children:p.menuItems.filter(e=>(0,b.mn)(D||void 0,e.href)).filter(e=>"/"!==e.href).map(e=>(0,l.jsxs)(m.default,{href:e.href,className:"flex flex-col items-center justify-center gap-3 rounded-xl border border-slate-200 bg-white p-6 shadow-sm transition-all hover:bg-slate-50 hover:shadow-md active:scale-95",children:[(0,l.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-blue-50 text-blue-600",children:(0,l.jsx)(e.icon,{className:"h-6 w-6"})}),(0,l.jsx)("span",{className:"font-bold text-slate-700 text-sm",children:e.name})]},e.href))})]}),!S&&(0,l.jsxs)("div",{className:"hidden md:block p-8",children:[(0,l.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-3xl font-bold text-slate-800",children:"Dashboard"}),(0,l.jsxs)(m.default,{href:"/is-emirleri?new=true",className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 font-medium text-white transition-colors hover:bg-blue-700",children:[(0,l.jsx)(n.Z,{className:"h-4 w-4"}),"Yeni İş Emri"]})]}),(0,l.jsxs)("div",{className:"mb-8 grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,l.jsxs)("div",{className:"rounded-xl border border-slate-100 bg-white p-6 shadow-sm",children:[(0,l.jsx)("div",{className:"mb-4 text-sm font-medium text-slate-500",children:"Toplam Gelir"}),(0,l.jsxs)("div",{className:"flex items-end justify-between",children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["₺",g.totalIncome.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,l.jsx)(i.Z,{className:"h-6 w-6 text-green-500"})]})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-slate-100 bg-white p-6 shadow-sm",children:[(0,l.jsx)("div",{className:"mb-4 text-sm font-medium text-slate-500",children:"Toplam Gider"}),(0,l.jsxs)("div",{className:"flex items-end justify-between",children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-red-600",children:["₺",g.totalExpense.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,l.jsx)(r.Z,{className:"h-6 w-6 text-red-500"})]})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-slate-100 bg-white p-6 shadow-sm",children:[(0,l.jsx)("div",{className:"mb-4 text-sm font-medium text-slate-500",children:"Net Kar"}),(0,l.jsxs)("div",{className:"flex items-end justify-between",children:[(0,l.jsxs)("div",{className:(0,o.cn)("text-2xl font-bold",g.netProfit>=0?"text-blue-600":"text-red-600"),children:["₺",g.netProfit.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,l.jsx)(i.Z,{className:"h-6 w-6 text-blue-500"})]})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-slate-100 bg-white p-6 shadow-sm",children:[(0,l.jsx)("div",{className:"mb-4 text-sm font-medium text-slate-500",children:"Bekleyen Tahsilat"}),(0,l.jsxs)("div",{className:"flex items-end justify-between",children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-orange-500",children:["₺",g.pendingCollection.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),(0,l.jsx)(d.Z,{className:"h-6 w-6 text-orange-500"})]})]})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-slate-100 bg-white shadow-sm",children:[(0,l.jsx)("div",{className:"border-b border-slate-100 p-6",children:(0,l.jsxs)("h3",{className:"flex items-center gap-2 text-lg font-bold text-slate-800",children:[(0,l.jsx)("span",{className:"text-slate-400",children:"\uD83D\uDCC5"})," \xd6n\xfcm\xfczdeki 10 G\xfcnde \xc7alışacak Personel"]})}),(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"mb-4 grid grid-cols-12 px-4 text-sm font-medium text-slate-500",children:[(0,l.jsx)("div",{className:"col-span-1",children:"G\xfcn"}),(0,l.jsx)("div",{className:"col-span-11 md:col-span-5",children:"Tarih"}),(0,l.jsx)("div",{className:"hidden md:block col-span-3 text-right",children:"İş Emri"}),(0,l.jsx)("div",{className:"hidden md:block col-span-3 text-right",children:"Personel"})]}),(0,l.jsx)("div",{className:"space-y-2",children:w?(0,l.jsx)("div",{className:"text-center py-8 text-slate-400",children:"Y\xfckleniyor..."}):0===v.length?(0,l.jsx)("div",{className:"text-center py-8 text-slate-400",children:"Yaklaşan iş bulunamadı."}):v.map(e=>(0,l.jsxs)("div",{className:(0,o.cn)("grid grid-cols-12 items-center rounded-lg px-4 py-4 transition-colors",e.isToday?"bg-blue-50/50":"hover:bg-slate-50"),children:[(0,l.jsx)("div",{className:"col-span-2 md:col-span-1",children:(0,l.jsx)("div",{className:(0,o.cn)("flex h-8 w-8 items-center justify-center rounded-full text-sm font-bold",e.isToday?"bg-blue-600 text-white":"bg-slate-100 text-slate-600"),children:e.day})}),(0,l.jsxs)("div",{className:"col-span-10 md:col-span-5 flex items-center gap-2",children:[e.isToday&&(0,l.jsx)("span",{className:"rounded bg-blue-100 px-2 py-0.5 text-xs font-bold text-blue-700",children:"Bug\xfcn"}),(0,l.jsx)("span",{className:(0,o.cn)("font-medium",e.isToday?"text-slate-900":"text-slate-600"),children:e.date})]}),(0,l.jsxs)("div",{className:"col-span-6 md:col-span-3 text-right text-sm font-medium text-slate-600 mt-2 md:mt-0",children:["\uD83D\uDCC4 ",e.jobs," iş emri"]}),(0,l.jsxs)("div",{className:"col-span-6 md:col-span-3 text-right text-sm font-medium text-slate-600 mt-2 md:mt-0",children:["\uD83D\uDC64 ",e.personnel," personel"]})]},e.id))}),(0,l.jsxs)("div",{className:"mt-8 relative",ref:T,children:[(0,l.jsx)("h3",{className:"text-sm font-bold text-slate-500 mb-3 ml-1",children:"Hızlı M\xfcşteri Arama"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(c.Z,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-slate-400"}),(0,l.jsx)("input",{type:"text",value:e,onChange:_,placeholder:"M\xfcşteri ara...",className:"w-full rounded-xl border border-slate-200 bg-white py-4 pl-12 pr-4 text-base shadow-sm outline-none focus:border-blue-500 focus:ring-4 focus:ring-blue-500/10 transition-all placeholder:text-slate-400"})]}),s.length>0&&(0,l.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl border border-slate-100 shadow-xl overflow-hidden z-10 animate-in fade-in slide-in-from-top-2 duration-200",children:s.map(e=>(0,l.jsxs)("button",{onClick:()=>Z.push("/musteriler?search=".concat(e.name)),className:"w-full flex items-center justify-between p-4 hover:bg-slate-50 transition-colors border-b border-slate-50 last:border-0 text-left",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-lg",children:e.name.charAt(0)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-bold text-slate-800",children:e.name}),(0,l.jsx)("p",{className:"text-sm text-slate-500",children:e.phone})]})]}),(0,l.jsx)("div",{className:"text-xs font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded",children:"Detaya Git"})]},e.id))})]})]})]})]})]})}},1232:function(e,t,s){"use strict";s.d(t,{h:function(){return x}});var l=s(3827),a=s(9108),n=s(1213),i=s(1049),r=s(8458),d=s(7907),c=s(8792),o=s(6288),m=s(5838);function x(e){let{title:t}=e,s=(0,d.useRouter)(),x=(0,d.usePathname)(),u=(0,r.e)(),{role:h,profile:f,loading:b}=(0,m.j)(),p=async()=>{try{await u.auth.signOut(),o.toast.success("\xc7ıkış yapıldı"),s.push("/login"),s.refresh()}catch(e){o.toast.error("\xc7ıkış yapılırken hata oluştu")}};return(0,l.jsxs)("header",{className:"flex h-20 items-center justify-between border-b bg-white px-4 md:px-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"md:hidden",children:"/"!==x&&(0,l.jsx)(c.default,{href:"/",className:"flex items-center justify-center p-2 -ml-2 text-slate-600 hover:bg-slate-100 rounded-full",children:(0,l.jsx)(a.Z,{className:"h-6 w-6"})})}),(0,l.jsx)("h2",{className:"text-lg md:text-xl font-bold text-slate-800 truncate max-w-[200px] md:max-w-none",children:t||"Y\xf6netim Paneli"})]}),(0,l.jsx)("div",{className:"flex items-center gap-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-3 rounded-full border border-slate-200 bg-slate-50 p-1 pl-4 pr-2",children:[(0,l.jsx)("div",{className:"flex flex-col items-end",children:b?(0,l.jsx)("span",{className:"text-xs text-slate-400",children:"Y\xfckleniyor..."}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"text-sm font-semibold text-slate-900",children:(null==f?void 0:f.full_name)||(null==f?void 0:f.name)||(null==f?void 0:f.email)||"Kullanıcı"}),(0,l.jsx)("span",{className:"text-xs text-slate-500 capitalize",children:h||"Yetkisiz"})]})}),(0,l.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-slate-200 text-slate-600",children:(0,l.jsx)(n.Z,{className:"h-5 w-5"})}),(0,l.jsx)("button",{onClick:p,className:"ml-2 rounded-full p-2 text-slate-400 hover:bg-slate-200 hover:text-slate-600 transition-colors",title:"\xc7ıkış Yap",children:(0,l.jsx)(i.Z,{className:"h-5 w-5"})})]})})]})}},9108:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},1049:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},94:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},8670:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},9733:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},1213:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(7461).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},function(e){e.O(0,[257,288,250,224,807,147,971,69,744],function(){return e(e.s=9980)}),_N_E=e.O()}]);